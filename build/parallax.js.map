{"version":3,"sources":["parallax.es6"],"names":["$","fn","parallax","method","methods","init","options","settings","extend","type","zoom","animateDuration","perspective","gyroAnimationType","scrollTop","windowHeight","triggerPosition","shift","innerHeight","window","on","height","each","_section","sectionHeight","outerHeight","_sectionInner","find","animationTriggerStart","animationTriggerEnd","offset","animationLength","coef","css","top","addClass","centerPixelShift","centerPercentShift","y","TweenLite","to","ease","Linear","easeNone","removeClass","ww","wh","deviceOrientation","innerWidth","text","$thisSection","$thisInner","innerSize","lastGamma","lastBeta","rangeGamma","rangeBeta","addEventListener","e","roundedGamma","Math","round","gamma","roundedBeta","beta","x","gamaInPercent","betaInPercent","set","transformStyle","rotationX","rotationY","sectionWidth","outerWidth","pageX","left","width","pageY","cursorPercentPositionX","cursorPercentPositionY","apply","Array","prototype","slice","call","arguments","error","jQuery"],"mappings":"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","file":"parallax.js","sourcesContent":["(function ($) {\n\n\n    $.fn.parallax = function (method) {\n\n        var methods = {\n\n            init: function (options) {\n\n                let settings = $.extend({\n                    type: 'scroll',\n                    zoom: 30,\n                    animateDuration: 0.5,\n                    perspective: 1200,\n                    gyroAnimationType: 'shift'\n                }, options);\n\n\n                if (settings.type == 'scroll') {\n\n                    let scrollTop, windowHeight, triggerPosition;\n                    let zoom = settings.zoom;\n                    let shift = zoom / 2;\n                    let innerHeight = zoom + 100;\n\n\n                    $(window).on('scroll load', function () {\n                        scrollTop = $(window).scrollTop();\n                        windowHeight = $(window).height();\n\n                        triggerPosition = scrollTop + windowHeight;\n                    });\n\n\n                    this.each(function () {\n\n\n                        let _section = $(this);\n                        let sectionHeight = _section.outerHeight();\n\n                        let _sectionInner = _section.find('.parallax-inner');\n\n                        let animationTriggerStart, animationTriggerEnd;\n\n                        let offset, animationLength;\n\n                        let coef = innerHeight / 100;\n\n\n                        _sectionInner.css({\n                            'top': -shift + '%',\n                            'left': 0,\n                            'height': innerHeight + '%',\n                            'width': '100%'\n                        });\n\n\n                        $(window).on('load resize', function () {\n\n                            offset = _section.offset();\n\n                            animationTriggerStart = offset.top;\n\n                            animationTriggerEnd = animationTriggerStart + windowHeight;\n\n                            animationLength = animationTriggerEnd - animationTriggerStart;\n                        });\n\n\n                        $(window).on('scroll resize load', function () {\n\n                            if (triggerPosition > animationTriggerStart && triggerPosition < animationTriggerEnd + sectionHeight) {\n\n                                _section.addClass('active');\n\n                                let centerPixelShift = triggerPosition - offset.top - (animationLength * 0.5);\n\n                                let centerPercentShift = centerPixelShift / (animationLength / 100) * 2;\n\n                                let y = shift / coef / 100 * centerPercentShift;\n\n\n                                TweenLite.to(_sectionInner, settings.animateDuration, {\n                                    y: y + '%',\n                                    ease: Linear.easeNone\n                                });\n\n                            }\n\n                            else {\n                                _section.removeClass('active');\n                            }\n\n                        })\n\n\n                    });\n                }\n\n                else if (settings.type == 'gyro') {\n\n                    let ww, wh, deviceOrientation;\n\n                    $(window).on('load resize', function () {\n                        ww = window.innerWidth;\n                        wh = window.innerHeight;\n\n                        if (ww > wh) {\n                            deviceOrientation = 'landscape'\n                        }\n\n                        else {\n                            deviceOrientation = 'portrait'\n                        }\n\n\n                        $('.debug .orientation').text(deviceOrientation);\n\n                    });\n\n                    this.each(function () {\n\n                        var animateDuration = settings.animateDuration;\n                        var zoom = settings.zoom;\n                        var shift = zoom / 2;\n                        var $thisSection = $(this);\n                        var $thisInner = $thisSection.find('.parallax-inner');\n                        var innerSize = shift * 2 + 100;\n                        var coef = innerSize / 100;\n\n                        var lastGamma, lastBeta, rangeGamma = 0, rangeBeta = 0;\n\n                        $thisInner.css({\n                            'top': -shift + '%',\n                            'left': -shift + '%',\n                            'height': innerSize + '%',\n                            'width': innerSize + '%'\n\n                        });\n\n\n                        window.addEventListener(\"deviceorientation\", function (e) {\n\n\n                            var roundedGamma = Math.round(e.gamma);\n                            var roundedBeta = Math.round(e.beta);\n                            var x, y;\n\n                            $('.debug .gamma').text(roundedGamma);\n                            $('.debug .beta').text(roundedBeta);\n\n                            if (roundedGamma > lastGamma && rangeGamma < 15) {\n                                rangeGamma++;\n                            }\n                            else if (roundedGamma < lastGamma && rangeGamma > -15) {\n                                rangeGamma--;\n                            }\n\n                            if (roundedBeta > lastBeta && rangeBeta < 15) {\n                                rangeBeta++;\n                            }\n                            else if (roundedBeta < lastBeta && rangeBeta > -15) {\n                                rangeBeta--;\n                            }\n\n                            lastGamma = roundedGamma;\n                            lastBeta = roundedBeta;\n\n                            var gamaInPercent = (100 / 15) * rangeGamma;\n                            var betaInPercent = (100 / 15) * rangeBeta;\n\n\n                            //TODO Organize orientation statement\n\n                            if (deviceOrientation == 'landscape') {\n                                x = shift / coef / 100 * betaInPercent;\n                                y = shift / coef / 100 * gamaInPercent;\n                            }\n\n                            else {\n                                x = shift / coef / 100 * gamaInPercent;\n                                y = (shift / coef / 100 * betaInPercent) * -1;\n                            }\n\n\n                            $('.debug .x').text(x);\n                            $('.debug .y').text(y);\n\n\n                            if (settings.gyroAnimationType == 'shift') {\n                                TweenLite.to($thisInner, animateDuration, {x: x + '%', y: y + '%'});\n                            }\n\n                            else if (settings.gyroAnimationType == 'rotate') {\n                                TweenLite.set($thisSection, {perspective:800});\n                                TweenLite.set($thisInner, {transformStyle:\"preserve-3d\"});\n                                TweenLite.to($thisInner, animateDuration, {rotationX: -y + '%', rotationY: -x + '%'});\n                            }\n\n\n                        }, true);\n\n\n                        $($thisSection).on(\"mousemove\", function (e) {\n\n                            var offset = $thisSection.offset();\n\n                            var sectionWidth = $thisSection.outerWidth();\n                            var sectionHeight = $thisSection.outerHeight();\n\n                            var pageX = e.pageX - offset.left - ($thisSection.width() * 0.5);\n                            var pageY = e.pageY - offset.top - ($thisSection.height() * 0.5);\n\n                            var cursorPercentPositionX = pageX / (sectionWidth / 100) * 2;\n                            var cursorPercentPositionY = pageY / (sectionHeight / 100) * 2;\n\n                            var x = shift / coef / 100 * cursorPercentPositionX;\n                            var y = shift / coef / 100 * cursorPercentPositionY;\n\n\n                            if (settings.gyroAnimationType == 'shift') {\n                                TweenLite.to($thisInner, animateDuration, {x: x + '%', y: y + '%'});\n                            }\n\n                            else if (settings.gyroAnimationType == 'rotate') {\n                                TweenLite.set($thisSection, {perspective: settings.perspective});\n                                TweenLite.set($thisInner, {transformStyle:\"preserve-3d\"});\n                                TweenLite.to($thisInner, animateDuration, {rotationX: y + '%', rotationY: -x + '%'});\n                            }\n\n                        });\n                    });\n                }\n            }\n        };\n\n\n        if (methods[method]) {\n            return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));\n        } else if (typeof method === 'object' || !method) {\n            return methods.init.apply(this, arguments);\n        } else {\n            $.error('There is no method with the name '+ method + ', for jQuery.parallax');\n        }\n    };\n    \n\n})(jQuery);\n"]}