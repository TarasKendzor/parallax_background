{"version":3,"sources":["parallax.es6"],"names":["$","fn","parallax","method","methods","init","options","settings","extend","type","zoom","gyroPerspective","gyroAnimationType","gyroAnimateDuration","scrollTop","windowHeight","triggerPosition","shift","innerHeight","window","on","height","this","each","_section","sectionHeight","outerHeight","_sectionInner","find","animationTriggerStart","animationTriggerEnd","offset","animationLength","coef","css","top","left","width","addClass","centerPixelShift","centerPercentShift","y","transform","removeClass","ww","wh","deviceOrientation","innerWidth","animateDuration","$thisSection","$thisInner","innerSize","lastGamma","lastBeta","rangeGamma","rangeBeta","TweenLite","set","perspective","transformStyle","addEventListener","e","roundedGamma","Math","round","gamma","roundedBeta","beta","x","gamaInPercent","betaInPercent","to","rotationX","rotationY","sectionWidth","outerWidth","pageX","pageY","cursorPercentPositionX","cursorPercentPositionY","mouseleave","apply","Array","prototype","slice","call","arguments","_typeof","error","jQuery"],"mappings":"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","file":"parallax.min.js","sourcesContent":["(function ($) {\n\n\n    $.fn.parallax = function (method) {\n\n        var methods = {\n\n            init: function (options) {\n\n                let settings = $.extend({\n                    type: 'scroll',\n                    zoom: 30,\n                    gyroPerspective: 1000,\n                    gyroAnimationType: 'shift',\n                    gyroAnimateDuration: 0.5\n                }, options);\n\n\n\n                if (settings.type == 'scroll') {\n\n                    let scrollTop = 0,\n                        windowHeight = 0,\n                        triggerPosition = 0,\n                        zoom = settings.zoom,\n                        shift = zoom / 2,\n                        innerHeight = zoom + 100;\n\n\n                    $(window).on('scroll load', function () {\n                        scrollTop = $(window).scrollTop();\n                        windowHeight = $(window).height();\n\n                        triggerPosition = scrollTop + windowHeight;\n                    });\n\n\n                    this.each(function () {\n\n\n                        let _section = $(this),\n                            sectionHeight = _section.outerHeight(),\n                            _sectionInner = _section.find('.parallax-inner'),\n                            animationTriggerStart = 0,\n                            animationTriggerEnd = 0,\n                            offset = 0,\n                            animationLength = 0,\n                            coef = innerHeight / 100;\n\n\n                        _sectionInner.css({\n                            'top': -shift + '%',\n                            'left': 0,\n                            'height': innerHeight + '%',\n                            'width': '100%'\n                        });\n\n\n                        $(window).on('load resize', function () {\n\n                            offset = _section.offset();\n\n                            animationTriggerStart = offset.top;\n\n                            animationTriggerEnd = animationTriggerStart + windowHeight;\n\n                            animationLength = animationTriggerEnd - animationTriggerStart;\n                        });\n\n\n                        $(window).on('scroll resize load', function () {\n\n                            if (triggerPosition > animationTriggerStart && triggerPosition < animationTriggerEnd + sectionHeight) {\n\n                                _section.addClass('active');\n\n                                let centerPixelShift = triggerPosition - offset.top - (animationLength * 0.5);\n\n                                let centerPercentShift = centerPixelShift / (animationLength / 100) * 2;\n\n                                let y = shift / coef / 100 * centerPercentShift;\n\n\n                                _sectionInner.css({\n                                    \"transform\": \"translate3d(0,\" + y + \"%, 0)\"\n                                });\n                            }\n\n                            else {\n                                _section.removeClass('active');\n                            }\n\n                        })\n\n\n                    });\n                }\n\n                else if (settings.type == 'gyro') {\n\n                    let ww = 0,\n                        wh = 0,\n                        deviceOrientation = 0;\n\n                    $(window).on('load resize', function () {\n                        ww = window.innerWidth;\n                        wh = window.innerHeight;\n\n                        if (ww > wh) {\n                            deviceOrientation = 'landscape'\n                        }\n\n                        else {\n                            deviceOrientation = 'portrait'\n                        }\n\n\n                    });\n\n                    this.each(function () {\n\n                        let animateDuration = settings.gyroAnimateDuration,\n                            zoom = settings.zoom,\n                            shift = zoom / 2,\n                            $thisSection = $(this),\n                            $thisInner = $thisSection.find('.parallax-inner'),\n\n                            innerSize = shift * 2 + 100,\n                            coef = innerSize / 100,\n\n                            lastGamma = 0,\n                            lastBeta = 0,\n                            rangeGamma = 0,\n                            rangeBeta = 0;\n\n\n                        $thisInner.css({\n                            'top': -shift + '%',\n                            'left': -shift + '%',\n                            'height': innerSize + '%',\n                            'width': innerSize + '%'\n\n                        });\n\n\n                        if (settings.gyroAnimationType == 'rotate') {\n                            TweenLite.set($thisSection, {perspective: settings.gyroPerspective});\n                            TweenLite.set($thisInner, {transformStyle: \"preserve-3d\"});\n                        }\n\n\n                        window.addEventListener(\"deviceorientation\", function (e) {\n\n\n                            let roundedGamma = Math.round(e.gamma),\n                                roundedBeta = Math.round(e.beta),\n                                x = 0,\n                                y = 0;\n\n                            // $('.debug .gamma').text(roundedGamma);\n                            // $('.debug .beta').text(roundedBeta);\n\n                            if (roundedGamma > lastGamma && rangeGamma < 15) {\n                                rangeGamma++;\n                            }\n                            else if (roundedGamma < lastGamma && rangeGamma > -15) {\n                                rangeGamma--;\n                            }\n\n                            if (roundedBeta > lastBeta && rangeBeta < 15) {\n                                rangeBeta++;\n                            }\n                            else if (roundedBeta < lastBeta && rangeBeta > -15) {\n                                rangeBeta--;\n                            }\n\n                            lastGamma = roundedGamma;\n                            lastBeta = roundedBeta;\n\n                            let gamaInPercent = (100 / 15) * rangeGamma,\n                                betaInPercent = (100 / 15) * rangeBeta;\n\n\n                            //TODO Organize orientation statement\n\n                            if (deviceOrientation == 'landscape') {\n                                x = shift / coef / 100 * betaInPercent;\n                                y = shift / coef / 100 * gamaInPercent;\n                            }\n\n                            else {\n                                x = shift / coef / 100 * gamaInPercent;\n                                y = (shift / coef / 100 * betaInPercent) * -1;\n                            }\n\n\n                            // $('.debug .x').text(x);\n                            // $('.debug .y').text(y);\n\n\n                            if (settings.gyroAnimationType == 'shift') {\n                                TweenLite.to($thisInner, animateDuration, {x: x + '%', y: y + '%'});\n                            }\n\n                            else if (settings.gyroAnimationType == 'rotate') {\n                                TweenLite.to($thisInner, animateDuration, {rotationX: -y + '%', rotationY: -x + '%'});\n                            }\n\n\n                        }, true);\n\n\n                        $thisSection.on(\"mousemove\", function (e) {\n\n                            let offset = $thisSection.offset(),\n\n                                sectionWidth = $thisSection.outerWidth(),\n                                sectionHeight = $thisSection.outerHeight(),\n\n                                pageX = e.pageX - offset.left - ($thisSection.width() * 0.5),\n                                pageY = e.pageY - offset.top - ($thisSection.height() * 0.5),\n\n                                cursorPercentPositionX = pageX / (sectionWidth / 100) * 2,\n                                cursorPercentPositionY = pageY / (sectionHeight / 100) * 2,\n\n                                x = shift / coef / 100 * cursorPercentPositionX,\n                                y = shift / coef / 100 * cursorPercentPositionY;\n\n\n                            // $('.debug .x').text(x);\n                            // $('.debug .y').text(y);\n\n                            if (settings.gyroAnimationType == 'shift') {\n                                TweenLite.to($thisInner, animateDuration, {x: x + '%', y: y + '%'});\n                                \n                            }\n\n                            else if (settings.gyroAnimationType == 'rotate') {\n                                TweenLite.to($thisInner, animateDuration, {rotationX: y + '%', rotationY: -x + '%'});\n                            }\n\n                        });\n\n\n                        $thisSection.mouseleave(function () {\n\n                            if (settings.gyroAnimationType == 'shift') {\n\n                                TweenLite.to($thisInner, animateDuration, {x: '0%', y: '0%'});\n                            }\n\n                            else if (settings.gyroAnimationType == 'rotate') {\n                                TweenLite.to($thisInner, animateDuration, {rotationX: 0, rotationY: 0});\n                            }\n\n                        });\n                    });\n                }\n            }\n        };\n\n\n        if (methods[method]) {\n            return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));\n        } else if (typeof method === 'object' || !method) {\n            return methods.init.apply(this, arguments);\n        } else {\n            $.error('There is no method with the name ' + method + ', for jQuery.parallax');\n        }\n    };\n\n\n})(jQuery);\n"]}